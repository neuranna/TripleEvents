% calculate fROI overlap EventsRev
addpath('/om5/group/evlab/u/annaiv/scripts');
addpath(genpath('/om/group/evlab/software/spm12'))

main_task = 'events2move_instrsep';
main_label = 'Events2move';
loc_task = 'langlocSN';
loc_label = 'lang';

main_fROIname = 'locT_0140_percentile-ROI-level0.1_max_0136_percentile-ROI-level0.1_a2b314f1bf0ae6c42dd4acb137923d73.ROIs.nii';
%loc_fROIname = 'locT_0003_percentile-ROI-level0.1_f2f281a0bb9ffa54f781c09b52273cdf.ROIs.nii';
loc_fROIname = 'locT_0003_percentile-ROI-level0.1_a2b314f1bf0ae6c42dd4acb137923d73.ROIs.nii';

experiment = 'Events2move';

experiments=struct(...
    'name', main_task, ...
    'pwd1','/mindhive/evlab/u/Shared/SUBJECTS/',...
    'pwd2_loc', ['firstlevel_' loc_task],...
    'pwd2_main', ['firstlevel_' main_task],...
    'data_loc', {{'199_KAN_parametric_20_PL2017',...
            '261_FED_20160523c_3T2_PL2017',...
            '291_FED_20160803c_3T1_PL2017',...
            '400_FED_20160520a_3T1_PL2017',...
            '407_FED_20160804a_3T1_PL2017',...
            '419_FED_20160805a_3T1_PL2017',...
            '408_FED_20160711a2_3T1_PL2017',...
            '409_FED_20160622a_3T1_PL2017',...
            '410_FED_20160623b_3T2_PL2017',...
            '730_FED_20190306a_3T2_PL2017',...
            '776_FED_20190611b_3T2_PL2017',...
            '773_FED_20190605c_3T2_PL2017',...
            '774_FED_20190605b_3T2_PL2017',...
            '775_FED_20190611a_3T2_PL2017',...
            '778_FED_20190614b_3T2_PL2017'}},...
    'data_main', {{'199_FED_20160711c_3T1_PL2017',...
    '261_FED_20160523c_3T2_PL2017',...
    '291_FED_20160803c_3T1_PL2017',...
    '400_FED_20160520a_3T1_PL2017',...
    '407_FED_20160804a_3T1_PL2017',...
    '419_FED_20160805a_3T1_PL2017',...
    '408_FED_20160711a2_3T1_PL2017',...
    '409_FED_20160622a_3T1_PL2017',...
    '410_FED_20160623b_3T2_PL2017',...
    '730_FED_20190306a_3T2_PL2017',...
    '776_FED_20190611b_3T2_PL2017',...
    '773_FED_20190605c_3T2_PL2017',...
    '774_FED_20190605b_3T2_PL2017',...
    '775_FED_20190611a_3T2_PL2017',...
    '778_FED_20190614b_3T2_PL2017'}});


spmfiles_loc={};
spmfiles_main={};
for nsub=1:length(experiments.data_main)
    spmfiles_loc{nsub}=fullfile(experiments.pwd1,experiments.data_loc{nsub},experiments.pwd2_loc,loc_fROIname);
    spmfiles_main{nsub}=fullfile(experiments.pwd1,experiments.data_main{nsub},experiments.pwd2_main,main_fROIname);
end

for nsub=1:length(experiments.data_main)
    experiments.data_main{nsub}
    output_file = fullfile(['/om5/group/evlab/u/annaiv/TripleEvents/fROI_Overlap_' experiment],...
        [experiments.data_main{nsub} '_' main_label '_' loc_label '_' experiment '.csv']);
    calculate_parcel_overlap(spmfiles_loc{nsub}, spmfiles_main{nsub}, output_file);
end